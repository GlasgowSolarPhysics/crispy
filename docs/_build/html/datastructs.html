

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Structures &mdash; crisPy2 0.4.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="API" href="API.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> crisPy2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="API.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data Structures</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">crisPy2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="API.html">API</a> &raquo;</li>
        
      <li>Data Structures</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/datastructs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-structures">
<h1>Data Structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="crisPy2.crisp.CRISP">
<em class="property">class </em><code class="sig-prename descclassname">crisPy2.crisp.</code><code class="sig-name descname">CRISP</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">wcs=None</em>, <em class="sig-param">uncertainty=None</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">nonu=False</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for a single narrowband CRISP observation. This object is intended to be for narrowband observations of a single spectral line. This can be sliced directly by virtue of inheriting from <cite>astropy</cite>’s <a class="reference external" href="https://docs.astropy.org/en/stable/nddata/">N-dimensional data slicing</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em> or </em><em>ObjDict</em>) – The file to be represented by the class. This can be in the form of a fits file or hdf5 file or an ObjDict object (see <code class="docutils literal notranslate"><span class="pre">crisPy2.utils</span></code> for more information on ObjDicts). For fits files, the imaging spectroscopy/spectropolarimetry is assumed to be in the PrimaryHDU of the fits file. For hdf5 it is assumed to have a hdf5 dataset called “data”.</p></li>
<li><p><strong>wcs</strong> (<em>astropy.wcs.WCS</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Defines the World Coordinate System (WCS) of the observation. If None, the WCS is constructed from the header information in the file. If a WCS is provided then it will be used by the class instead.</p></li>
<li><p><strong>uncertainty</strong> (<em>numpy.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The uncertainty in the observable. Default is None.</p></li>
<li><p><strong>mask</strong> (<em>numpy.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The mask to be applied to the data. Default is None.</p></li>
<li><p><strong>nonu</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not the <span class="math notranslate nohighlight">\(\Delta \lambda\)</span> on the wavelength axis is uniform. This is helpful when constructing the WCS but if True, then the <code class="docutils literal notranslate"><span class="pre">CRISPNonU</span></code> class should be used. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>file</strong> – This is where the data and header are stored as attributes to this attribute. e.g. <code class="docutils literal notranslate"><span class="pre">file.data</span></code> returns the data and <code class="docutils literal notranslate"><span class="pre">file.header</span></code> returns the header</p></li>
<li><p><strong>wcs</strong> – This stores the WCS.</p></li>
<li><p><strong>nonu</strong> – This is either True or False depending what is passed to the nonu kwarg.</p></li>
<li><p><strong>uncertainty</strong> – This is the uncertainty array.</p></li>
<li><p><strong>mask</strong> – The mask to be used on the data.</p></li>
<li><p><strong>aa</strong> – The html symbol for Angstrom because it looks nicer in plotting than the LaTeX one that matplotlib renders.</p></li>
<li><p><strong>a</strong> – The html symbol for alpha.</p></li>
<li><p><strong>l</strong> – The html symbol for lambda.</p></li>
<li><p><strong>D</strong> – The html symbol for Delta.</p></li>
<li><p><strong>shape</strong> – The shape of the data from <code class="docutils literal notranslate"><span class="pre">file</span></code>. Much easier than doing <code class="docutils literal notranslate"><span class="pre">file.data.shape</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="crisPy2.crisp.CRISP.from_lonlat">
<code class="sig-name descname">from_lonlat</code><span class="sig-paren">(</span><em class="sig-param">lon</em>, <em class="sig-param">lat</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP.from_lonlat" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes a Helioprojective Longitude, Helioprojective Latitude pair and converts them to the y, x indices to index the object correctly. The function takes its arguments in the order Helioprojective Longitude, Helioprojective Latitude but returns the indices in the (y,x) format so that the output of this function can be used to directly index the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>float</em>) – The Helioprojective Longitude in arcseconds.</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – The Helioprojective Latitude in arcseconds.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISP.intensity_map">
<code class="sig-name descname">intensity_map</code><span class="sig-paren">(</span><em class="sig-param">frame=None</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP.intensity_map" title="Permalink to this definition">¶</a></dt>
<dd><p>This plots the image for a certain wavelength depending on a specific slice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The units to use on the axes. Default is None so the WCS is used. Other option is “pix” for pixel frame.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISP.plot_spectrum">
<code class="sig-name descname">plot_spectrum</code><span class="sig-paren">(</span><em class="sig-param">unit=None</em>, <em class="sig-param">air=False</em>, <em class="sig-param">d=False</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP.plot_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the intensity spectrum for a specified coordinate by slicing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit</strong> (<em>astropy.units.Unit</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The unit to have the wavelength axis in. Default is None which changes the units to Angstrom.</p></li>
<li><p><strong>air</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to convert the wavelength axis to air wavelength (if it is not already been converted). e.g. for the Ca II 8542  spectral line, 8542 is the rest wavelength of the spectral line measured in air. It is possible that the header data (and by proxy the WCS) will have the value of the rest wavelength in vacuum (which in this case is 8544). Default is False.</p></li>
<li><p><strong>d</strong> (<em>bool</em><em>, </em><em>optional</em>) – Converts the wavelength axis to <span class="math notranslate nohighlight">\(\Delta \lambda\)</span>. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISP.plot_stokes">
<code class="sig-name descname">plot_stokes</code><span class="sig-paren">(</span><em class="sig-param">stokes</em>, <em class="sig-param">unit=None</em>, <em class="sig-param">air=False</em>, <em class="sig-param">d=False</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP.plot_stokes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the Stokes profiles for a given slice of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stokes</strong> (<em>str</em>) – This is to ensure the plots are labelled correctly. Choose “all” to plot the 4 Stokes profiles or a combination e.g. “IQU”, “QV” or single letter to plot just one of the Stokes parameters e.g. “U”.</p></li>
<li><p><strong>unit</strong> (<em>astropy.units.Unit</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The unit to have the wavelength axis in. Default is None which changes the units to Angstrom.</p></li>
<li><p><strong>air</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to convert the wavelength axis to air wavelength (if it is not already been converted). e.g. for the Ca II 8542  spectral line, 8542 is the rest wavelength of the spectral line measured in air. It is possible that the header data (and by proxy the WCS) will have the value of the rest wavelength in vacuum (which in this case is 8544). Default is False.</p></li>
<li><p><strong>d</strong> (<em>bool</em><em>, </em><em>optional</em>) – Converts the wavelength axis to <span class="math notranslate nohighlight">\(\Delta \lambda\)</span>. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISP.stokes_map">
<code class="sig-name descname">stokes_map</code><span class="sig-paren">(</span><em class="sig-param">stokes</em>, <em class="sig-param">frame=None</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP.stokes_map" title="Permalink to this definition">¶</a></dt>
<dd><p>This plots the Stokes images for certain wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stokes</strong> (<em>str</em>) – This is to ensure the plots are labelled correctly. Choose “all” to plot the 4 Stokes profiles or a combination e.g. “IQU”, “QV” or single letter to plot just one of the Stokes parameters e.g. “U”.</p></li>
<li><p><strong>frame</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The units to use on the axes. Default is None so the WCS is used. Other option is “pix” for pixel frame.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISP.to_lonlat">
<code class="sig-name descname">to_lonlat</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP.to_lonlat" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will take a y, x coordinate in pixel space and map it to Helioprojective Longitude, Helioprojective Latitude according to the transform in the WCS. This will return the Helioprojective coordinates in units of arcseconds. Note this function takes arguments in the order of numpy indexing (y,x) but returns a pair longitude/latitude which is Solar-X, Solar-Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>int</em>) – The y-index to be converted to Helioprojective Latitude.</p></li>
<li><p><strong>x</strong> (<em>int</em>) – The x-index to be converted to Helioprojective Longitude.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISP.wave">
<code class="sig-name descname">wave</code><span class="sig-paren">(</span><em class="sig-param">idx</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISP.wave" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will take an index number or range and return the wavelength in Angstroms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em><em> or </em><em>numpy.ndarray of ints</em>) – The index or indices along the wavelength axis to be converted to physical units.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="crisPy2.crisp.CRISPSequence">
<em class="property">class </em><code class="sig-prename descclassname">crisPy2.crisp.</code><code class="sig-name descname">CRISPSequence</code><span class="sig-paren">(</span><em class="sig-param">files</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISPSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for multiple narrowband CRISP observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>files</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – A list of dictionaries containing the parameters for individual <code class="docutils literal notranslate"><span class="pre">CRISP</span></code> instances. The function <code class="docutils literal notranslate"><span class="pre">crisPy2.utils.CRISP_sequence_generator</span></code> can be used to generate this list.</p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><strong>list</strong> – A list of <code class="docutils literal notranslate"><span class="pre">CRISP</span></code> instances.</p>
</dd>
</dl>
<dl class="method">
<dt id="crisPy2.crisp.CRISPSequence.intensity_map">
<code class="sig-name descname">intensity_map</code><span class="sig-paren">(</span><em class="sig-param">idx</em>, <em class="sig-param">frame=None</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISPSequence.intensity_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for plotting the intensity image for a given wavelength. Can be done either for all of the instances or for a single instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>str</em><em> or </em><em>int</em>) – If “all” then the spectrum for a specific slice is plotted for all instances. If an int, then the spectrum for a specific slice for a specific instance is plotted.</p></li>
<li><p><strong>frame</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The units to use on the axes. Default is None so the WCS is used. Other option is “pix” for pixel frame.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISPSequence.plot_spectrum">
<code class="sig-name descname">plot_spectrum</code><span class="sig-paren">(</span><em class="sig-param">idx</em>, <em class="sig-param">unit=None</em>, <em class="sig-param">air=False</em>, <em class="sig-param">d=False</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISPSequence.plot_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for plotting the intensity spectrum for a given slice. Can be done either for all of the instances or for a single instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>str</em><em> or </em><em>int</em>) – If “all” then the spectrum for a specific slice is plotted for all instances. If an int, then the spectrum for a specific slice for a specific instance is plotted.</p></li>
<li><p><strong>unit</strong> (<em>astropy.units.Unit</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The unit to have the wavelength axis in. Default is None which changes the units to Angstrom.</p></li>
<li><p><strong>air</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to convert the wavelength axis to air wavelength (if it is not already been converted). e.g. for the Ca II 8542  spectral line, 8542 is the rest wavelength of the spectral line measured in air. It is possible that the header data (and by proxy the WCS) will have the value of the rest wavelength in vacuum (which in this case is 8544). Default is False.</p></li>
<li><p><strong>d</strong> (<em>bool</em><em>, </em><em>optional</em>) – Converts the wavelength axis to <span class="math notranslate nohighlight">\(\Delta \lambda\)</span>. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISPSequence.plot_stokes">
<code class="sig-name descname">plot_stokes</code><span class="sig-paren">(</span><em class="sig-param">idx</em>, <em class="sig-param">stokes</em>, <em class="sig-param">unit=None</em>, <em class="sig-param">air=False</em>, <em class="sig-param">d=False</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISPSequence.plot_stokes" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for plotting the Stokes profiles for a given slice. Can be done either for all of the instances or for a single instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>str</em><em> or </em><em>int</em>) – If “all” then the spectrum for a specific slice is plotted for all instances. If an int, then the spectrum for a specific slice for a specific instance is plotted.</p></li>
<li><p><strong>stokes</strong> (<em>str</em>) – This is to ensure the plots are labelled correctly. Choose “all” to plot the 4 Stokes profiles or a combination e.g. “IQU”, “QV” or single letter to plot just one of the Stokes parameters e.g. “U”.</p></li>
<li><p><strong>unit</strong> (<em>astropy.units.Unit</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The unit to have the wavelength axis in. Default is None which changes the units to Angstrom.</p></li>
<li><p><strong>air</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to convert the wavelength axis to air wavelength (if it is not already been converted). e.g. for the Ca II 8542  spectral line, 8542 is the rest wavelength of the spectral line measured in air. It is possible that the header data (and by proxy the WCS) will have the value of the rest wavelength in vacuum (which in this case is 8544). Default is False.</p></li>
<li><p><strong>d</strong> (<em>bool</em><em>, </em><em>optional</em>) – Converts the wavelength axis to <span class="math notranslate nohighlight">\(\Delta \lambda\)</span>. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="crisPy2.crisp.CRISPSequence.stokes_map">
<code class="sig-name descname">stokes_map</code><span class="sig-paren">(</span><em class="sig-param">idx</em>, <em class="sig-param">stokes</em>, <em class="sig-param">frame=None</em><span class="sig-paren">)</span><a class="headerlink" href="#crisPy2.crisp.CRISPSequence.stokes_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot the Stokes maps for a given wavelength. Can be done either for all of the instances or for a single instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>str</em><em> or </em><em>int</em>) – If “all” then the spectrum for a specific slice is plotted for all instances. If an int, then the spectrum for a specific slice for a specific instance is plotted.</p></li>
<li><p><strong>stokes</strong> (<em>str</em>) – This is to ensure the plots are labelled correctly. Choose “all” to plot the 4 Stokes profiles or a combination e.g. “IQU”, “QV” or single letter to plot just one of the Stokes parameters e.g. “U”.</p></li>
<li><p><strong>frame</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The units to use on the axes. Default is None so the WCS is used. Other option is “pix” for pixel frame.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="API.html" class="btn btn-neutral float-left" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, John A. Armstrong

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>